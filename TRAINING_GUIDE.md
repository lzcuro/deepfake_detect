# π€ GenConViT λ¨λΈ ν•™μµ κ°€μ΄λ“

## π“‹ κ°μ”
GenConViT λ¨λΈμ νμΈνλ‹μ„ μ„ν• ν•™μµ μ¤ν¬λ¦½νΈμ…λ‹λ‹¤. RTX 5090 GPU μµμ ν™”

## π› οΈ μ„¤μΉ λ° μ„¤μ •

### μμ΅΄μ„± μ„¤μΉ
```bash
pip install -r requirements.txt

μ¶”κ°€λ΅ ν„μ¬ RTX5090 μ‹λ¦¬μ¦λ¥Ό μ§€μ›ν•λ” cuda λ²„μ Όμ€ μ•„λμ™€ κ°™μ, μ΄ λν• μ •μ‹ λ²„μ Όμ€ μ•„λ‹λ‹¤.
pip install --pre torch torchvision torchaudio --index-url https://download.pytorch.org/whl/nightly/cu128
```

### ν•™μµ λ°μ΄ν„° κµ¬μ„±
```bash
μ „μ²΄ Real μ΄λ―Έμ§€: 79,900κ°
μ „μ²΄ Fake μ΄λ―Έμ§€: 421,339κ°
μ „μ²΄ μ΄κ³„: 501,239κ°

π“ λ¶„ν•  λΉ„μ¨ ν™•μΈ:
------------------------------
TRAIN:
  Real λΉ„μ¨: 70.0% (55,900κ°)
  Fake λΉ„μ¨: 70.0% (294,907κ°)
  μ „μ²΄ λΉ„μ¨: 70.0% (350,807κ°)
VALID:
  Real λΉ„μ¨: 15.0% (12,000κ°)
  Fake λΉ„μ¨: 15.0% (63,215κ°)
  μ „μ²΄ λΉ„μ¨: 15.0% (75,215κ°)
TEST:
  Real λΉ„μ¨: 15.0% (12,000κ°)
  Fake λΉ„μ¨: 15.0% (63,217κ°)
  μ „μ²΄ λΉ„μ¨: 15.0% (75,217κ°)
```


## π“ λ§¤κ°λ³€μ μ„¤λ…

| λ§¤κ°λ³€μ | μ„¤λ… | κΈ°λ³Έκ°’ |
|---------|------|--------|
| `-d, --data` | ν•™μµ λ°μ΄ν„° κ²½λ΅ | ν•„μ |
| `-e, --epochs` | ν•™μµ μ—ν¬ν¬ μ | ν•„μ |
| `-b, --batch_size` | λ°°μΉ ν¬κΈ° | 32 |
| `-m, --model` | λ¨λΈ νƒ€μ… (ed/vae) | ν•„μ (λ‹¨μΌ λ¨λΈλ§) |
| `-p, --pretrained` | μ‚¬μ „ ν›λ ¨λ λ¨λΈ νμΌ | μ„ νƒμ‚¬ν•­ |
| `--pretrained_ed` | ED λ¨λΈ μ‚¬μ „ ν›λ ¨ νμΌ | μ„ νƒμ‚¬ν•­ |
| `--pretrained_vae` | VAE λ¨λΈ μ‚¬μ „ ν›λ ¨ νμΌ | μ„ νƒμ‚¬ν•­ |


**νμΈνλ‹ νΉμ§•:**
- π”§ μλ™μΌλ΅ ν•™μµλ¥ μ„ κΈ°λ³Έκ°’μ 10%λ΅ μ„¤μ • (0.0001 β†’ 0.00001)
- π”„ κΈ°μ΅΄ λ¨λΈ κ°€μ¤‘μΉμ™€ μµν‹°λ§μ΄μ € μƒνƒ λ³µμ›
- π“ μ΄μ „ ν•™μµ μ΄λ ¥μ—μ„ μ΄μ–΄μ„ ν•™μµ κ°€λ¥


## π’Ύ μ¶λ ¥ νμΌ

ν•™μµ μ™„λ£ ν›„ λ‹¤μ νμΌλ“¤μ΄ μƒμ„±λ©λ‹λ‹¤:

### λ‹¨μΌ λ¨λΈ ν•™μµ
- `weight/genconvit_{model}_{timestamp}.pth` - μµμΆ… λ¨λΈ κ°€μ¤‘μΉ
- `weight/genconvit_{model}_{timestamp}.pkl` - ν•™μµ νμ¤ν† λ¦¬
- `weight/best_genconvit_{model}.pth` - μµκ³  μ„±λ¥ λ¨λΈ

### λ‘ λ¨λΈ λ™μ‹ ν•™μµ
- `weight/genconvit_ed_{timestamp}.pth` - ED λ¨λΈ μµμΆ… κ°€μ¤‘μΉ
- `weight/genconvit_vae_{timestamp}.pth` - VAE λ¨λΈ μµμΆ… κ°€μ¤‘μΉ
- `weight/best_genconvit_ed.pth` - ED λ¨λΈ μµκ³  μ„±λ¥
- `weight/best_genconvit_vae.pth` - VAE λ¨λΈ μµκ³  μ„±λ¥


## π¨ μ£Όμμ‚¬ν•­

1. **GPU λ©”λ¨λ¦¬**: RTX 5090μ κ²½μ° λ°°μΉ ν¬κΈ°λ¥Ό 64 μ΄μƒμΌλ΅ μ„¤μ • κ°€λ¥
2. **λ°μ΄ν„° κ²½λ΅**: `sample_train_data` ν΄λ” κµ¬μ΅°κ°€ μ¬λ°”λ¥Έμ§€ ν™•μΈ
3. **WandB**: μΈν„°λ„· μ—°κ²°μ΄ ν•„μ”ν•λ©°, λ΅κ·ΈμΈ μƒνƒλ¥Ό μ μ§€ν•΄μ•Ό ν•¨
4. **λ¨λΈ μ €μ¥**: μ¶©λ¶„ν• λ””μ¤ν¬ κ³µκ°„ ν™•λ³΄ (λ¨λΈλ‹Ή μ•½ 500MB)

#### ED λ¨λΈ ν•™μµ
```bash
python train_simple.py -d sample_train_data -m ed -e 10 -b 32
```

#### VAE λ¨λΈ ν•™μµ
```bash
python train_simple.py -d sample_train_data -m vae -e 10 -b 32
```

#### μ‚¬μ „ ν›λ ¨λ λ¨λΈλ΅ νμΈνλ‹
```bash
# ED λ¨λΈ νμΈνλ‹
python train_simple.py -d sample_train_data -m ed -e 5 -b 32 -p weight/genconvit_ed_inference.pth

# VAE λ¨λΈ νμΈνλ‹
python train_simple.py -d sample_train_data -m vae -e 5 -b 32 -p weight/genconvit_vae_inference.pth

# λ³‘λ ¬ νμΈνλ‹
python train_simple.py -d sample_train_data -m both -e 5 -b 32 \
  --pretrained-ed weight/genconvit_ed_inference.pth \
  --pretrained-vae weight/genconvit_vae_inference.pth
```


### **λ§¤κ°λ³€μ μ„¤λ…**

| λ§¤κ°λ³€μ | μ„¤λ… | κΈ°λ³Έκ°’ |
|---------|------|--------|
| `-d, --data` | ν•™μµ λ°μ΄ν„° κ²½λ΅ | ν•„μ |
| `-e, --epochs` | ν•™μµ μ—ν¬ν¬ μ | ν•„μ |
| `-b, --batch_size` | λ°°μΉ ν¬κΈ° | 32 |
| `-m, --model` | λ¨λΈ νƒ€μ… (ed/vae) | ν•„μ |
| `-p, --pretrained` | μ‚¬μ „ ν›λ ¨λ λ¨λΈ νμΌ | μ„ νƒμ‚¬ν•­ |

### **μ¶λ ¥ μμ‹**
```
π€ GenConViT κ°„λ‹¨ ν•™μµ μ‹μ‘! (WandB μ—†μ΄)
π“ λ°μ΄ν„° κ²½λ΅: sample_train_data
π”„ μ—ν¬ν¬ μ: 5
π“¦ λ°°μΉ ν¬κΈ°: 32
π¤– λ¨λΈ νƒ€μ…: ed
π”„ μ‚¬μ „ ν›λ ¨ λ¨λΈ: weight/genconvit_ed_inference.pth

============================================================
π¤– ED (Autoencoder) λ¨λΈ ν•™μµ μ‹μ‘
============================================================
π”§ νμΈνλ‹ λ¨λ“: ν•™μµλ¥  0.000010 (κΈ°λ³Έκ°’μ 10%)
π”„ μ‚¬μ „ ν›λ ¨λ λ¨λΈ λ΅λ”©: weight/genconvit_ed_inference.pth
π€ ν•™μµ μ‹μ‘! (5 μ—ν¬ν¬)

β±οΈ  μ—ν¬ν¬ 0 μ™„λ£ μ‹κ°„: 45.23μ΄
π“ ν„μ¬ ν•™μµλ¥ : 0.000010
π“ ν•™μµ μ†μ‹¤: 0.6234
π“ κ²€μ¦ μ†μ‹¤: 0.5891
π“ κ²€μ¦ μ •ν™•λ„: 0.7234
--------------------------------------------------
π† μƒλ΅μ΄ μµκ³  μ„±λ¥! λ¨λΈ μ €μ¥: weight/best_genconvit_ed.pth
```


10/28 ν•™μµ λ΅κ·Έ 
[VAE (Variational Autoencoder)] EPOCH 10/30 | β–β–β–β–β–β–β–β–β–β–β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘β–‘ |  33.3%
[VAE (Variational Autoencoder)] μ‹κ°„: 2461.81μ΄ | ν•™μµλ¥ : 1.00e-05
[VAE (Variational Autoencoder)] ν•™μµ μ†μ‹¤:   0.1009 | β†‘ κ²€μ¦ μ†μ‹¤:   0.1105
[VAE (Variational Autoencoder)] κ²€μ¦ μ •ν™•λ„:  90.74% | β†‘ κ°μ„ : +78.24%
------------------------------------------------------------
[VAE (Variational Autoencoder)] β οΈ  10/10 μ—ν¬ν¬ λ™μ• κ°μ„  μ—†μ

[VAE (Variational Autoencoder)] π›‘ Early Stopping! 10 μ—ν¬ν¬ λ™μ• κ°μ„  μ—†μ–΄μ„ ν•™μµ μ¤‘λ‹¨
[VAE (Variational Autoencoder)] β… μµκ³  μ„±λ¥: μ—ν¬ν¬ 0, μ†μ‹¤ 0.0000

============================================================
β“ VAE (Variational Autoencoder) ν•™μµ μ™„λ£!
============================================================
μ΄ μ†μ” μ‹κ°„: 440λ¶„ 41μ΄
μµμΆ… κ²€μ¦ μ •ν™•λ„: 90.74%
μµμΆ… κ²€μ¦ μ†μ‹¤: 0.1105
μµκ³  μ„±λ¥: μ—ν¬ν¬ 0, μ†μ‹¤ 0.0000
============================================================
[VAE (Variational Autoencoder)] λ¨λΈ μ €μ¥ μ™„λ£: weight\genconvit_vae_Oct_28_2025_02_08_15.pth
============================================================

================================================================================
π‰ λ³‘λ ¬ ν•™μµ μ™„λ£!
================================================================================
μ „μ²΄ μ‹¤ν–‰ μ‹κ°„: 440.9λ¶„

π“ μµμΆ… κ²°κ³Ό λΉ„κµ:
================================================================================
λ¨λΈ                   μ •ν™•λ„        μ†μ‹¤         μµκ³  μ—ν¬ν¬       ν•™μµμ‹κ°„
--------------------------------------------------------------------------------
ED (Autoencoder)        94.77%   0.0111          0    438.7λ¶„
VAE (Variational Autoencoder)    90.74%   0.1105          0    440.7λ¶„

π† μµκ³  μ„±λ¥ λ¨λΈ: ED (Autoencoder)
   μ •ν™•λ„: 94.77%
   μ†μ‹¤: 0.0111
   λ¨λΈ νμΌ: weight\genconvit_ed_Oct_28_2025_02_06_15.pth
================================================================================